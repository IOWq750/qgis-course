<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Упражнение 3 Привязка и цифрование административной карты | Основы геоинформатики: практикум (QGIS)</title>
  <meta name="description" content="Упражнения по курсу «Основы геоинформатики» для студентов кафедры картографии и геоинформатики географического факультета МГУ имени М.В. Ломоносова" />
  <meta name="generator" content="bookdown 0.17 and GitBook 2.6.7" />

  <meta property="og:title" content="Упражнение 3 Привязка и цифрование административной карты | Основы геоинформатики: практикум (QGIS)" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Упражнения по курсу «Основы геоинформатики» для студентов кафедры картографии и геоинформатики географического факультета МГУ имени М.В. Ломоносова" />
  <meta name="github-repo" content="tsamsonov/arcgis-course" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Упражнение 3 Привязка и цифрование административной карты | Основы геоинформатики: практикум (QGIS)" />
  
  <meta name="twitter:description" content="Упражнения по курсу «Основы геоинформатики» для студентов кафедры картографии и геоинформатики географического факультета МГУ имени М.В. Ломоносова" />
  

<meta name="author" content="Андрей Энтин, Тимофей Самсонов" />


<meta name="date" content="2020-03-04" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="map-design-quaternary.html"/>
<link rel="next" href="manual-catalog.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />












<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Введение</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#регламент"><i class="fa fa-check"></i>Регламент</a></li>
</ul></li>
<li class="part"><span><b>I Основы работы с QGIS</b></span></li>
<li class="chapter" data-level="1" data-path="map-design-general.html"><a href="map-design-general.html"><i class="fa fa-check"></i><b>1</b> Создание общегеографической карты</a><ul>
<li class="chapter" data-level="1.1" data-path="map-design-general.html"><a href="map-design-general.html#map-design-general-intro"><i class="fa fa-check"></i><b>1.1</b> Введение</a><ul>
<li class="chapter" data-level="1.1.1" data-path="map-design-general.html"><a href="map-design-general.html#map-design-general-checklist"><i class="fa fa-check"></i><b>1.1.1</b> Контольный лист</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="map-design-general.html"><a href="map-design-general.html#map-design-general-begin"><i class="fa fa-check"></i><b>1.2</b> Начало работы</a></li>
<li class="chapter" data-level="1.3" data-path="map-design-general.html"><a href="map-design-general.html#map-design-general-projection"><i class="fa fa-check"></i><b>1.3</b> Настройка системы координат</a></li>
<li class="chapter" data-level="1.4" data-path="map-design-general.html"><a href="map-design-general.html#map-design-general-navigation"><i class="fa fa-check"></i><b>1.4</b> Навигация по карте</a></li>
<li class="chapter" data-level="1.5" data-path="map-design-general.html"><a href="map-design-general.html#map-design-general-relief"><i class="fa fa-check"></i><b>1.5</b> Оформление рельефа</a></li>
<li class="chapter" data-level="1.6" data-path="map-design-general.html"><a href="map-design-general.html#map-design-general-vector"><i class="fa fa-check"></i><b>1.6</b> Добавление векторных наборов данных</a></li>
<li class="chapter" data-level="1.7" data-path="map-design-general.html"><a href="map-design-general.html#map-design-general-attributes"><i class="fa fa-check"></i><b>1.7</b> Использование атрибутов объектов при визуализации</a></li>
<li class="chapter" data-level="1.8" data-path="map-design-general.html"><a href="map-design-general.html#map-design-general-labels"><i class="fa fa-check"></i><b>1.8</b> Подписи</a></li>
<li class="chapter" data-level="1.9" data-path="map-design-general.html"><a href="map-design-general.html#map-design-general-layout"><i class="fa fa-check"></i><b>1.9</b> Настройка компоновки карты</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="map-design-quaternary.html"><a href="map-design-quaternary.html"><i class="fa fa-check"></i><b>2</b> Создание карты четвертичных отложений</a><ul>
<li class="chapter" data-level="2.1" data-path="map-design-quaternary.html"><a href="map-design-quaternary.html#map-design-quaternary-intro"><i class="fa fa-check"></i><b>2.1</b> Введение</a><ul>
<li class="chapter" data-level="2.1.1" data-path="map-design-quaternary.html"><a href="map-design-quaternary.html#map-design-quaternary-checklist"><i class="fa fa-check"></i><b>2.1.1</b> Контольный лист</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="map-design-quaternary.html"><a href="map-design-quaternary.html#map-design-quaternary-begin"><i class="fa fa-check"></i><b>2.2</b> Начало работы</a></li>
<li class="chapter" data-level="2.3" data-path="map-design-quaternary.html"><a href="map-design-quaternary.html#map-design-quaternary-data"><i class="fa fa-check"></i><b>2.3</b> Добавление данных в проект</a></li>
<li class="chapter" data-level="2.4" data-path="map-design-quaternary.html"><a href="map-design-quaternary.html#map-design-quaternary-classification"><i class="fa fa-check"></i><b>2.4</b> Применение готового стиля к слою</a></li>
<li class="chapter" data-level="2.5" data-path="map-design-quaternary.html"><a href="map-design-quaternary.html#map-design-quaternary-csv"><i class="fa fa-check"></i><b>2.5</b> Создание набора пространственных данных из таблицы с координатами</a></li>
<li class="chapter" data-level="2.6" data-path="map-design-quaternary.html"><a href="map-design-quaternary.html#map-design-quaternary-final"><i class="fa fa-check"></i><b>2.6</b> Оформление карты</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="map-ref-economic.html"><a href="map-ref-economic.html"><i class="fa fa-check"></i><b>3</b> Привязка и цифрование административной карты</a><ul>
<li class="chapter" data-level="3.1" data-path="map-ref-economic.html"><a href="map-ref-economic.html#map-ref-economic-intro"><i class="fa fa-check"></i><b>3.1</b> Введение</a><ul>
<li class="chapter" data-level="3.1.1" data-path="map-ref-economic.html"><a href="map-ref-economic.html#map-ref-economic-control"><i class="fa fa-check"></i><b>3.1.1</b> Контрольный лист</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="map-ref-economic.html"><a href="map-ref-economic.html#map-ref-economic-basemap"><i class="fa fa-check"></i><b>3.2</b> Добавление базовых данных</a></li>
<li class="chapter" data-level="3.3" data-path="map-ref-economic.html"><a href="map-ref-economic.html#map-ref-economic-referencing"><i class="fa fa-check"></i><b>3.3</b> Привязка карты</a></li>
<li class="chapter" data-level="3.4" data-path="map-ref-economic.html"><a href="map-ref-economic.html#map-ref-districts-creation"><i class="fa fa-check"></i><b>3.4</b> Создание слоя избирательных округов</a></li>
<li class="chapter" data-level="3.5" data-path="map-ref-economic.html"><a href="map-ref-economic.html#map-ref-districts-stats"><i class="fa fa-check"></i><b>3.5</b> Расчет статистики по округам</a></li>
</ul></li>
<li class="appendix"><span><b>Справочные сведения</b></span></li>
<li class="chapter" data-level="A" data-path="manual-catalog.html"><a href="manual-catalog.html"><i class="fa fa-check"></i><b>A</b> Форматы пространственных данных</a><ul>
<li class="chapter" data-level="A.1" data-path="manual-catalog.html"><a href="manual-catalog.html#шейп-файлы"><i class="fa fa-check"></i><b>A.1</b> Шейп-файлы</a></li>
<li class="chapter" data-level="A.2" data-path="manual-catalog.html"><a href="manual-catalog.html#geopackage"><i class="fa fa-check"></i><b>A.2</b> GeoPackage</a></li>
<li class="chapter" data-level="A.3" data-path="manual-catalog.html"><a href="manual-catalog.html#базы-геоданных-esri"><i class="fa fa-check"></i><b>A.3</b> Базы геоданных ESRI</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Основы геоинформатики: практикум (QGIS)</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="map-ref-economic" class="section level1">
<h1><span class="header-section-number">Упражнение 3</span> Привязка и цифрование административной карты</h1>
<div id="map-ref-economic-intro" class="section level2">
<h2><span class="header-section-number">3.1</span> Введение</h2>
<p><strong>Цель задания</strong> — знакомство с привязкой, трансформированием и цифрованием геоизображений, элементами базовых технологий ГИС (оверлей, пространственные запросы).</p>
<p><strong>Необходимая теоретическая подготовка:</strong> Системы координат и проекции карт, привязка геоизображений, трансформирование геоизображений, цифрование геоизображений. Методы трансформации: аффинное, проективное, полиномиальное, метод резинового листа (сплайны). Пространственные запросы, атрибутивные запросы, оверлей.</p>
<p><strong>Необходимая практическая подготовка:</strong> Знание основных компонент интерфейса QGIS (менеджер источников данных, панель слоёв, фрейм карты, окно настройки компоновки). Добавление источников пространственных данных в проект. Настройка символики и подписей объектов. Создание макета, добавление карты и зарамочного оформления, экспорт макета.</p>
<p><strong>Исходные данные:</strong> Cлои картографической основы OpenStreetMap, растровая карта избирательных округов г. Белгорода.</p>
<p><strong>Результат:</strong> Набор пространственных данных с избирательными округами г. Белгорода и статистикой по застройке в пределах округов. Картодиаграммы по количеству домов и степени застроенности. Картографическое изображение.</p>
<div id="map-ref-economic-control" class="section level3">
<h3><span class="header-section-number">3.1.1</span> Контрольный лист</h3>
<ul>
<li>Привязать растровую карту к опорным данным</li>
<li>Создать класс избирательных округов путем цифрования растровой карты</li>
<li>Добавить номера районов в таблицу атрибутов</li>
<li>Определить (путем применения серии пространственных запросов) структуру застройки в каждом округе</li>
<li>Построить картодиаграммы по полученным значениям</li>
<li>Подготовить проект карты с компоновкой</li>
</ul>
</div>
</div>
<div id="map-ref-economic-basemap" class="section level2">
<h2><span class="header-section-number">3.2</span> Добавление базовых данных</h2>
<p><a href="map-ref-economic.html#map-ref-economic">В начало упражнения ⇡</a></p>
<ol style="list-style-type: decimal">
<li><p>Скачайте архив и распакуйте его в свою рабочую директорию.</p></li>
<li><p>Создайте проект QGIS и сохраните его в распакованную папку (<em>Ex05_RefAdm</em>) в своей рабочей директории.</p></li>
<li><p>В менеджере источников данных найдите расположение проекта и разверните содержимое базы <code>belgorod.gpkg</code>.</p>
<p><img src="images/Ex05/GeoPackage_structure.png" /></p>
<blockquote>
<p>Формат <a href="http://www.geopackage.org/">GeoPackage</a> был предложен в середине 2010-х как открытая <a href="https://imgs.xkcd.com/comics/standards.png">альтернатива существующим форматам</a> хранения пространственных данных: <a href="http://switchfromshapefile.org/#shapefileisbad">шейп-файлу</a> и базам геоданных ESRI. GeoPackage представляет собой базу данных SQLite, внутри которой содержатся таблицы с данными и таблицы с метаданными. Такой подход аналогичен базе геоданных ESRI. Однако, в отличие от базы геоданных и от шейп-файлов, GeoPackage хранит всю необходимую информацию в одном файле (*.gpkg). Это позиционируется как одно из главных преимуществ формата.</p>
</blockquote></li>
<li><p>Добавьте все наборы из базы <code>belgorod.gpkg</code> на карту.</p>
<blockquote>
<p><em>Примечание: проще всего сделать это через менеджер источников данных. Другой вариант — перетащить файл из окна системного файлового менеджера.</em></p>
</blockquote></li>
<li><p>Разместите слои в следующем порядке и настройте их символику:</p>
<ul>
<li><strong>железные дороги:</strong> тёмно-серые линии толщиной 0,4 мм;</li>
<li><strong>автодороги:</strong> светло-оранжевые линии толщиной 0,26 мм;</li>
<li><strong>здания и сооружения:</strong> заливка светло-серого цвета без обводки;</li>
<li><strong>водоёмы:</strong> используйте стиль <code>topo water</code>;</li>
<li><strong>водотоки:</strong> синие линии толщиной 0,26 мм;</li>
<li><strong>административные границы:</strong> иcпользуйте стиль <code>outline red</code>.</li>
</ul>
<p>Задайте слоям русскоязычные названия</p></li>
<li><p>Отобразите карту в охвате слоя границ.</p>
<p><strong>Скриншот 1:</strong> окно QGIS после завершения настройки символики</p>
<p><strong>Вопрос 1:</strong> какая система координат используется в проекте? Для чего обычно применяется эта система координат?</p></li>
</ol>
</div>
<div id="map-ref-economic-referencing" class="section level2">
<h2><span class="header-section-number">3.3</span> Привязка карты</h2>
<p><a href="map-ref-economic.html#map-ref-economic">В начало упражнения ⇡</a></p>
<ol style="list-style-type: decimal">
<li><p>Для привязки растров в QGIS имеется модуль «Привязка растров (GDAL)». Чтобы запустить его, выберите «Растр» — «Привязка растров…». Откроется окно модуля привязки.</p>
<blockquote>
<p>Примечание: Если в меню «Растр» нет нужного пункта, следует зайти в меню «Модули» — «Управление модулями…» и в разделе «Установленные» включить модуль «Привязка растров (GDAL)». «Привязка растров» — модуль, который входит в ядро QGIS, он обязательно устанавливается вместе с основной программой.</p>
</blockquote></li>
<li><p>В окне привязки нажмите кнопку «Открыть растр» и откройте файл <code>ElectionMap.jpg</code>, который находится в вашей рабочей директории. При загрузке QGIS попросит вас указать систему координат для добавляемого растра. Выбирайте ту же систему координат, которая используется в проекте.</p></li>
<li><p>Расположите окно модуля привязки таким образом, чтобы оно не закрывало основной фрейм карты. Выключите панели инструментов QGIS, если они вам мешают.</p>
<p><img src="images/Ex05/Reference1.png" /></p>
<p>Обратите внимание, что растровое изображение выглядит искажённым («сплюснутым») по сравнению с изображением в основном окне QGIS. Если вы откроете растр в какой-либо программе просмотра изображений, вы убедитесь, что растр действительно будто бы «сжат» по вертикали.</p></li>
<li><p>Перемещаясь по карте, найдите соответствующие точки на изображении и в основном окне QGIS</p>
<p><img src="images/Ex05/Reference2.png" /></p></li>
<li><p>Используя инструмент «Добавить точку» в окне модуля привязки, установите первую точку на растровом изображении (щелчком левой кнопки мыши). QGIS выдаст запрос на ввод координат:</p>
<p><img src="images/Ex05/Reference3.png" /></p></li>
<li><p>В некоторых случаях можно ввести координаты вручную, но нам будет проще «снять их с карты», то есть указать соответственную точку в основном окне QGIS. Нажмите кнопку «С карты». Окна модуля привязки при этом свернутся.</p></li>
<li><p>Щёлкните левой кнопкой мыше в соответствующей точке основного окна QGIS. Программа автоматически считает координаты точки и подставит их в форму:</p>
<p><img src="images/Ex05/Reference4.png" /></p></li>
<li><p>Нажмите OK, чтобы добавить первую опорную точку.</p>
<blockquote>
<p>Примечание: счёт опорных точек в QGIS начинается с нуля, поэтому первая точка получит индекс «0», вторая — «1» и так далее.</p>
</blockquote></li>
<li><p><strong>Найдите и расставьте ещё 7-8 опорных точек.</strong>. Точки должны быть равномерно распределены по полю карты и не находиться на одной линии. В качестве опорных точек лучше всего использовать пересечения автодорог и/или железных дорог. Кроме того, не следует использовать контура границ для расстановки опорных точек — в представленных материалах они не совпадают!</p></li>
<li><p>Откройте окно параметров трансформации <img src="images/Ex05/parameters.png" /> и ознакомьтесь с доступными параметрами трансформации.</p>
<p><strong>Вопрос 2:</strong> какие типы трансформации растра доступны в QGIS? В каких случаях они применяются? Сколько точек необходимо для осуществления каждого типа трансформации?</p></li>
<li><p>Настройте параметры трансформации следующим образом:</p>
<ul>
<li><strong>Тип трансформации:</strong> Проективная;</li>
<li><strong>Метод интерполяции:</strong> Ближайший сосед;</li>
<li><strong>Целевая система координат:</strong> такая же, как СК проекта;</li>
<li>Остальные параметры оставьте по умолчанию</li>
<li>Обязательно включите опцию «Открыть результат в QGIS»</li>
</ul></li>
<li><p>Нажмите ОК, чтобы закрыть окно параметров трансформации и сохранить изменения настроек.</p></li>
<li><p>Изучите таблицу опорных точек, которая отображается внизу окна модуля привязки. Если суммарная невязка для какой-либо точки превышает 0,5 пикселя, отключите её и добавьте новую точку. Не удаляйте отключённые точки!</p>
<blockquote>
<p>Подсказка: чтобы легче было ориентироваться в опорных точках, можно включить отображение идентификаторов точек в настройках модуля привязки.</p>
</blockquote>
<p><strong>Вопрос 3:</strong> Можно ли загружать и сохранять опорные точки привязки в QGIS? Если да, как это сделать?</p></li>
<li><p>Когда точность всех активных опорных точек составит меньше 1 пикселя, нажмите кнопку <img src="images/Ex05/go.png" />, чтобы запустить процесс привязки. В результате будет создан новый файл, который автоматически добавится в основное окно QGIS.</p></li>
<li><p>Изучите результат привязки. Если он устраивает вас, окно привязки можно закрывать. Если нет, удалите добавленный слой, вернитесь в окно привязки, внесите необходимые изменения и запустите привязку ещё раз.</p>
<p><strong>Скриншот 2:</strong> окно QGIS после завершения привязки.</p></li>
</ol>
</div>
<div id="map-ref-districts-creation" class="section level2">
<h2><span class="header-section-number">3.4</span> Создание слоя избирательных округов</h2>
<p><a href="map-ref-economic.html#map-ref-economic">В начало упражнения ⇡</a></p>
<ol style="list-style-type: decimal">
<li><p>Отключите все слои, кроме административных границ. Измените стиль слоя границ на <code>outline black</code>. Разместите привязанный растр в таблице слоёв под слоем административных границ.</p>
<p>Мы готовы к тому, чтобы начать векторизовать («цифровать») контура избирательных округов. Но для этого нам нужен набор данных, в который мы будем сохранять создаваемые объекты. На следующем шаге мы создадим такой набор данных.</p></li>
<li><p><strong>Создайте новый набор данных GeoPackage</strong>. Это можно сделать из панели источников данных, из меню «слой» или нажав комбинацию клавиш <code>Ctrl+Shift+N</code>. Откроется окно настройки нового слоя.</p></li>
<li><p>Заполните поля в открывшемся окне следующим образом:</p>
<ul>
<li><strong>База данных:</strong> сохраните файл <code>*.gpkg</code> в папку <code>Ex05_RefAdm</code>. Назовите его по шаблону <code>Belgorod_%фамилия%.gpkg</code>;</li>
<li><strong>Имя таблицы:</strong> примите значение, предлагаемое по умолчанию после указания пути к базе;</li>
<li><strong>Тип геометрии:</strong> <em>(определите самостоятельно)</em></li>
<li>Чекбоксы «Include Z dimension» и «Include M values» оставьте выключенными;</li>
<li><strong>Система координат</strong>: такая же, как система координат проекта.</li>
</ul></li>
<li><p>Блоки <em>New Field</em> и <em>Fields List</em> предназначены для настройки таблицы атрибутов создаваемого набора данных. В блоке <em>New Field</em> вводится имя, тип и длина поля, по нажатию кнопки <em>Add to Fields list</em> создаваемое поле добавляется в список.</p>
<p>Добавьте поле <strong>district_id</strong> целочисленного типа в список полей.</p>
<p>не раскрывайте блок <em>Advanced Options</em>, они не интересуют нас в рамках этого упражнения.</p>
<p>После применения всех настроек окно создания нового набора будет выглядеть аналогично представленному на экране:</p>
<p><img src="images/Ex05/NewGeoPackage.png" /></p></li>
<li><p>Нажмите ОК, чтобы создать источник данных. Новый слой автоматически добавится в проект.</p>
<p>На следующих шагах вы будете создавать новые пространственные объекты в этом слое.</p></li>
<li><p>Измените стиль слоя на <code>pattern dot red</code>. Такая символика удобна для цифрования, поскольку позволит не «скрывать» растровый слой под созданными объектами.</p></li>
<li><p>Редактирование данных в ГИС по умолчанию «выключено». Чтобы получить возможность редактировать наборы данных, нужно включать специальный режим редактирования. В QGIS этот режим включается отдельно для каждого слоя. Чтобы включить режим редактирования, выберите слой, который вы собираетесь редактировать, в таблице слоёв и нажмите кнопку <img src="images/Ex05/Editing1.png" /> на панели инструментов оцифровки.</p></li>
<li><p>Включив режим редактирования, нажмите кнопку «Добавить объект» <img src="images/Ex05/Editing2.png" /> в панели инструментов оцифровки, чтобы добавить новый объект. Внешний вид и название этой кнопки будут отличаться в зависимости от типа геометрии слоя.</p></li>
<li><p>Включите панель инструментов прилипания, если она ещё не включена.</p>
<p><img src="images/Ex05/snapping.png" /></p>
<blockquote>
<p>Примечание: прилипание (<em>snapping</em>, снеппинг) и его частный случай — трассировка (<em>tracing</em>) — исключительно важные функции программных средств ГИС. Они позволяют повторять контура уже существующих объектов при редактировании. Это не только ускоряет процесс, но и позволяет соблюдать специфические геоинформационные требования к топологии пространственных данных.</p>
</blockquote></li>
<li><p>В панели инструментов прилипания:</p>
<ul>
<li>Включите прилипание;</li>
<li>Установите режим прилипания «к вершинам и сегментам»</li>
<li>Порог прилипания — не меньше 10 пикселей</li>
<li>Включите трассировку (<em>Tracing</em>)</li>
</ul>
<p>Эти настройки нужны, чтобы контура создаваемых вами объектов повторяли контура слоя административных границ, где это необходимо.</p>
<p>Теперь вы готовы к тому, чтобы оцифровать свой первый контур. Ваша задача будет состоять в том, чтобы оцифровать границы избирательных округов в пределах одного из административных округов Белгорода (Западного или Восточного).</p></li>
<li><p>Увеличьте изображение таким образом, чтобы видеть избирательные округа возле южного сегмента границы двух административных округов. Нажмите левой кнопкой мыши на карте в месте, где проходит граница избирательного округа и не проходит граница административного округа. По нажатию левой кнопки мыши устанавливается положение первого узла создаваемого контура.</p></li>
<li><p>«Обходите» контур по часовой стрелке или против часовой стрелки, устанавливая новые узлы.</p>
<p><img src="images/Ex05/Editing4.png" /></p>
<p>Не пугайтесь, если QGIS отобразит зелёный крестик поверх вашего контура — таким образом маркируются самопересечения.</p>
<p>Чтобы удалить последний введённый узел, нажмите <code>Backspace</code>. Чтобы сбросить контур целиком, нажмите <code>Esc</code>.</p></li>
<li><p>Дойдя до границы административных округов, установите новый узел на ней. Место установки узла автоматически притянется к границе.</p>
<p><img src="images/Ex05/Editing5.png" /></p></li>
<li><p>Теперь переместите курсор вдоль границы. Наблюдайте за тем, как ориентируется контур создаваемого объекта. Установите следующий узел на границе подальше от точки касания.</p>
<p><img src="images/Ex05/Editing6.png" /></p></li>
<li><p>Когда границы округов «разойдутся», снова нажимайте левую кнопку мыши, чтобы установить новый узел в желаемой точке.</p></li>
<li><p>Чтобы завершить редактирование, нажмите правую кнопку мыши. Откроется окно ввода атрибутов. Введите номер избирательного округа и нажмите ОК или Enter, чтобы применить изменения и закрыть окно ввода атрибутов.</p>
<p>Новый объект добавлен в слой и отображается на карте.</p>
<blockquote>
<p>Примечание: неправильно введённый номер можно исправить в таблице атрибутов</p>
</blockquote></li>
<li><p>Векторизуйте остальные объекты в пределах выделенной вам половины г. Белгорода. Следуйте границам административных округов и ранее оцифрованных объектах. При незначительных различиях в границах цифруйте по границам административных округов, если расхождения большие — цифруйте по границам избирательных округов.</p></li>
<li><p>Сохраните изменения в слое. Для этого нажмите кнопку «Сохранить правки» <img src="images/Ex05/Editing7.png" /> на панели инструментов оцифровки. Не выключайте режим редактирования.</p>
<blockquote>
<p>Примечание: сохранение правок в слое никак не сказывается на сохранении проекта и независимо от него. Вы можете сохранить проект, затем в другом проекте изменить один из наборов пространственных данных, затем вернуться в изначальный проект — и все изменения набора отобразятся в нём. На символику слоя это не повлияет.</p>
</blockquote></li>
<li><p>Отключите растровый слой. Включите для набора данных об избирательных округах подписи по полю <code>district_id</code>. Настройки подписей задайте самостоятельно.</p>
<p><strong>Скриншот 3:</strong> оцифрованные контура избирательных округов.</p></li>
</ol>
</div>
<div id="map-ref-districts-stats" class="section level2">
<h2><span class="header-section-number">3.5</span> Расчет статистики по округам</h2>
<p><a href="map-ref-economic.html#map-ref-economic">В начало упражнения ⇡</a></p>
<p>В данной части работы предлагается определить количество зданий разных типов (жилые многоэтажки и частная застройка), которые попадают в пределы каждого округа, затем построить картодиаграммы по полученным значениям. Для этого будет использован следующий алгоритм:</p>
<ul>
<li><p>Выбрать округ на карте</p></li>
<li><p>Выбрать здания, попадающие в его пределы (<em>пространственный запрос</em>).</p></li>
<li><p>Из полученной выборки оставить только здания, принадлежащие к определённому типу (<em>атрибутивный запрос</em>).</p></li>
<li><p>Записать число отобранных зданий в соответствующий атрибут текущего района.</p></li>
</ul>
<p>Эти операции необходимо повторить для каждого округа.</p>
<ol style="list-style-type: decimal">
<li><p>Не выключая режим редактирования, откройте таблицу атрибутов слоя.</p></li>
<li><p>Нажмите кнопку «Добавить новое поле» или <code>Ctrl+W</code> на клавиатуре, чтобы добавить новый столбец в таблицу.</p></li>
<li><p>Добавьте два целочисленных поля: <code>count_apartments</code> и <code>count_house</code>. Эти поля будут служить для подсчёта (<em>count</em>) многоквартирных жилых домов (<em>apartments</em>) и частной застройки (<em>house</em>) соответственно.</p></li>
<li><p>Включите слой зданий.</p></li>
<li><p><strong>Выберите</strong> первый созданный вами контур округа: выделите строку в таблице атрибутов или воспользуйтесь инструментом выборки в окне карты <img src="images/Ex05/selection1.png" />. Выделенный объект будет подсвечен жёлтым цветом на карте и синим — в таблице атрибутов.</p></li>
<li><p>Теперь выберите те объекты из слоя зданий, которые находятся внутри выбранного округа. Для этого запустите инструмент «Вектор» — «Выборка» — «Выделение по районам…». Используйте условие «находятся внутри» (<em>are within</em>).</p>
<p><img src="images/Ex05/selection2.png" /></p>
<p>Нажмите «Выполнить», чтобы выбрать объекты в слое зданий.</p></li>
<li><p>Имея выборку в слое зданий и не закрывая окно пространственного запроса («Выделение по районам…»), осуществите выборку по атрибутам. Для этого выберите в таблице слоёв слой зданий и нажмите кнопку «Выделить объекты, удовлетворяющие условию» <img src="images/Ex05/selection3.png" />. Откроется форма ввода атрибутивного запроса.</p>
<blockquote>
<p>Атрибутивные запросы в ГИС, как правило, создаются с использованием диалектов языка <a href="https://ru.wikipedia.org/wiki/SQL">SQL</a>. Само выражение представляет собой только условие (<em>where clause</em>) и часто использует значения атрибутов.</p>
</blockquote></li>
<li><p>Форма ввода атрибутивного запроса состоит из трёх частей. В левой части конструируется собственно запрос, средняя содержит список доступных переменных и функций, в правой отображается справочная и служебная информация.</p></li>
<li><p>В структуре тегов OpenStreetMap многоэтажные жилые дома обозначаются тегом <code>apartments</code>. После конвертации данных OpenStreetMap в реляционную базу данных соответствующий тег содержится в поле <code>buildings</code>.</p>
<p>Мы должны <strong>выбрать</strong> в слое зданий те объекты, значение атрибута <code>buildings</code> которых задано как <code>apartments</code>.</p></li>
<li><p>Найдите в среднем поле группу «Поля и значения» и разверните её. Найдите поле «Building» и дважды щёлкните по нему левой кнопкой мыши. Поле будет добавлено в запрос, в нижней части окна появится пример результата запроса, а в правой части отобразится вспомогательная форма извлечения уникальных значений.</p></li>
<li><p>Введите знак <code>=</code> в поле конструирования запроса.</p></li>
<li><p>Нажмите кнопку <em>All Unique</em>, чтобы получить список уникальных значений, записанных в поле <code>building</code>.</p></li>
<li><p>Дважды щёлкните по записи <code>apartments</code> в списке уникальных значений. Она будет добавлена в конструктор запроса.</p>
<p>После применения всех действий окно конструктора запроса будет выглядеть, как на рисунке ниже:</p>
<p><img src="images/Ex05/selection4.png" /></p>
<p><strong>Вопрос 4:</strong> Почему в нижней части окна отображается запись «Предпросмотр: 0»?</p></li>
<li><p>Мы сформулировали условие для выборки, однако нам нужно выбрать объекты не просто из слоя, а из уже существующей выборки. Для этого откройте выпадающий список кнопки «Выбрать объекты» и выберите функцию «Фильтровать текущее выделение»:</p>
<p><img src="images/Ex05/selection5.png" /></p></li>
<li><p>После применения фильтра появится всплывающее сообщение с числом выбранных объектов. Эта информация будет продублирована внизу окна QGIS:</p>
<p><img src="images/Ex05/selection6.png" /></p></li>
<li><p>Введите полученную цифру в таблицу атрибутов слоя избирательных округов.</p></li>
<li><p>Повторите выборку поочерёдно для каждого округа. Вводите получаемые значения в таблицу атрибутов. Не забывайте периодически сохранять изменения!</p></li>
<li><p>Теперь повторите выборку ещё раз, но уже не для многоквартирных домов, а для частных владений. Им соответствует запись <code>house</code> в поле <code>building</code>.</p>
<p><strong>Вопрос 5:</strong> вставьте в отчёт SQL-выражение для выбора частных владений.</p>
<p><strong>Вопрос 6:</strong> можно ли было делать выборку в другом порядке (т.е. сначала выборку по атрибутам, а затем — по пространственному положению)? Если да, то каковы были бы отличия процедуры?</p></li>
<li><p>Скопируйте таблицу атрибутов в любой табличный процессор (Microsoft Excel, Google Sheets, LibreOffice Calc). Для этого при помощи сочетания клавиш <code>Ctrl+A</code> выделите все записи в таблице, скопируйте при помощи <code>Ctrl+C</code> и вставьте записи без форматирования в табличный процессор при помощи <code>Ctrl+Shift+V</code>.</p></li>
<li><p>Удалите первый столбец (<code>wkt_geometry</code>).</p></li>
<li><p><strong>Скопируйте остальные столбцы и вставьте их в отчётный файл</strong>.</p></li>
</ol>

</div>
</div>



            </section>

          </div>
        </div>
      </div>
<a href="map-design-quaternary.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="manual-catalog.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["qgis-course.pdf", "qgis-course.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
