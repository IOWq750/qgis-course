[
["index.html", "Основы геоинформатики: практикум (QGIS) Введение Регламент", " Основы геоинформатики: практикум (QGIS) Андрей Энтин, Тимофей Самсонов 2020-03-17 Введение Практикум разрабатывается для студентов кафедры картографии и геоинформатики географического факультета МГУ имени М.В. Ломоносова. Упражнения выполяются в свободно распространяемом ГИС-пакете QGIS версии 3.4. На занятиях вы можете пользоваться стационарными компьютерами в аудитории 1903, а для выполнения домашних работ вам нужно будет установить QGIS на ваши личные машины. Сдавать отчёты и домашние работы мы будем через Google Classroom. Для того, чтобы присоединиться к курсу, нужно: Зарегистрировать аккаунт Google. Для этого не обязательно создавать почтовый ящик в Google Mail, можно воспользоваться любой имеющейся почтой. Зайти на главную страницу Google Classroom (https://classroom.google.com) Присоединиться к курсу по коду glb5hvb. Практиум находится в разработке, поэтому вы неизбежно столкнётесь с ошибками в данных, процедурах и текстах упражнений. О любых найденных ошибках, опечатках и выявленных проблемах с программным обеспечением прошу немедленно сообщать преподавателю одним из следующих способов: через систему учёта ошибок GitHub (Issues), через Classroom, по электронной почте. Сейчас практикум доступен только в формате HTML, возможность его использования в других форматах (PDF, EPUB) будет реализована позже. Перед выполнением практикума необходимо внимательно ознакомиться с регламентом и тщательно придерживаться его при выполнении заданий. Регламент Вы можете выполнять упражнения как на своих личных компьютерах, так и на стационарных компьютерах, которые имеются в аудитории 1903. Если вы пользуетесь личным компьютером, рекомендую создать папку GIS в корне одного из дисков и помещать материалы упражнений туда. Если вы работаете на компьютерах в 1903, соблюдайте следующие требования: Ваша личная рабочая директория должна иметь адрес D:\\GIS\\&lt;ваша кафедра&gt;\\&lt;фамилия&gt; Например, студент 207 группы Петров хранит результаты своей работы в каталоге D:\\GIS\\207_CAR\\Petrov. Если в группе есть несколько человек с одинаковой фамилией, добавляйте к фамилии первые буквы имени и отчества, например: D:\\GIS\\207_CAR\\PetrovIS Каждое задание вы начинаете с того, что копируете соответствующую папку в свою директорию на локальном диске D. Исходные данные для выполнения упражнений размещаются в виде файлового архива в Google Classroom. Вы скачиваете этот архив и распаковываете его в свою директорию Отчётные файлы по упражнениям сдаются только через Classroom. "],
["map-design-general.html", "Упражнение 1 Создание общегеографической карты 1.1 Введение 1.2 Начало работы 1.3 Настройка системы координат 1.4 Навигация по карте 1.5 Оформление рельефа 1.6 Добавление векторных наборов данных 1.7 Использование атрибутов объектов при визуализации 1.8 Подписи 1.9 Настройка компоновки карты", " Упражнение 1 Создание общегеографической карты Архив с данными и файлом отчёта 1.1 Введение Цель задания — знакомство с моделями пространственных объектов и базой пространственных данных. Визуализация данных на карте. Оформление легенды и компоновки карты. Необходимая теоретическая подготовка: модели пространственных данных, модели пространственных объектов, базы пространственных объектов, картографические проекции. Необходимая практическая подготовка: практическая подготовка не требуется. Исходные данные: база географических данных на территорию Кавказских гор, собранная из нескольких источников. Ожидаемый результат: общегеографическая карта гор Кавказа и прилегающих территорий масштаба 1:4 500 000. 1.1.1 Контольный лист Добавить на карту источники пространственных данных и настроить их оформление Настроить подписи объектов Создать компоновку карты и легенду Экспортировать результат в графический файл 1.2 Начало работы В начало упражнения ⇡ Скачайте архив с исходными данными для упражнения и распакуйте его в свою рабочую директорию. Запустите QGIS. Для запуска воспользуйтесь иконкой с названием QGIS Desktop 3.4.15 with GRASS 7.8.2. Найдите панель менеджера источников данных и откройте Менеджер источников данных. В менеджере источников данных в режиме браузера найдите вашу рабочую директорию, а в ней — каталог Ex01_GeneralMap\\raster_data. В этом каталоге отображается единственный источник данных — 30n030e_20101117_gmted_mea075.tif. Иконка и расширение \\*.tif (Tagged Image Tile Format) подсказывают вам, что этот источник представляет пространственные данные в растровой (регулярно-сеточной) модели. Замечание 1: растр, с которым вы будете работать сейчас, сохранён в формате GeoTIFF. От «обычного» TIFF этот формат отличается тем, что сведения о пространственной привязке в GeoTIFF записываются непосредственно в файл с данными, в то время как «обычный» формат TIFF не поддерживает запись сведений о пространственной привязке, поэтому она хранится отдельно — в world-файле. В дальнейшем вы часто будете работать и с тем, и с другим способом хранения пространственных данных. Замечание 2: файл 30n030e_20101117_gmted_mea075.tif является фрагментом («тайлом») глобальной цифровой модели рельефа (ЦМР) GMTED2010. Этот источник часто используется для геоинформационного анализа и картографирования. Загрузить тайлы GMTED2010 можно через сервис EarthExplorer геологической службы США. Дважды щёлкните левой кнопкой мыши на название файла 30n030e_20101117_gmted_mea075.tif в менеджере источников данных. В панель слоёв (по умолчанию слева) добавится слой с названием 30n030e_20101117_gmted_mea075. Сохраните проект QGIS в папку с материалами упражнения (на том же иерархическом уровне, где находятся . Назовите его по шаблону &lt;Ex01_%Фамилия%&gt;, где %Фамилия% — ваша фамилия латинскими буквами. Скриншот 1: Окно QGIS после загрузки набора данных. Примечание: файл проекта QGIS (*.qgs, *.qgz) и документ карты ArcGIS (*.mxd) отличаются от тех файлов, с которыми вы работали ранее. В этих файлах не хранятся пространственные данные, а только ссылки на них и настройки их отображения (включая порядок слоёв, символику и подписи). Если вы перемещаете файл проекта относительно источников данных, ссылки «теряются». Поэтому важно правильно организовать структуру ГИС-проекта. В рамках нашего упражнения мы разместили файл проекта в директории более высокого уровня по отношению к тем директориям, где лежат данные. Теперь, если мы переместим всю папку Ex01 вместе со всем её содержимым, относительные пути от файла проекта до файлов данных не изменятся, и проект сохранит работоспособность. Разумеется, такое простое решение не будет оптимальным для крупных организаций с разветвлённой структурой сетевых ресурсов, но для студенческих проектов оно, как правило, работает 1.3 Настройка системы координат В начало упражнения ⇡ В правом нижнем углу карты вы видите надпись . Нажмите на эту надпись, чтобы открыть интерфейс выбора системы координат проекта. В открывшемся окне вы видите более подробную информацию об используемой системе координат. Код EPSG:4326 соответствует системе географических координат WGS 84. Термин «географическая система координат» (geographic coordinate systems) в ГИС означает, что координаты объектов и линейные параметры растров хранятся в виде широты и долготы. Альтернативный подход — проецированные системы координат (projected coordinate systems), где плановые координаты измеряются в метрических единицах. Система координат проекта была импортирована из первого (в нашем случае — пока единственного) загруженного источника пространственных данных. Система координат WGS 84, как правило, не используется для картографирования, поэтому мы изменим систему координат проекта. К настоящему моменту вы ещё не освоили курс «Математическая картография», в котором подробно разбираются вопросы разработки и выбора проекций для различных карт. Поэтому мы воспользуемся простым инструментом для выбора проекции — Projection Wizard. Перейдите на сайт Projection Wizard. Настройте параметры территории и проекции следующим образом: Класс проекции по виду искажений: равнопромежуточная Охват территории картографирования: от 39° с.ш. до 46° с.ш., от 36° в.д. до 51° в.д. Вам будет предложено две проекции. Нажмите на ссылку PROJ.4, соответствующей косой азимутальной проекции. В верхней части экрана будет отображено всплывающее окно с параметрами выбранной проекции в формате PROJ. формат PROJ, ранее известный как PROJ.4 — один из трёх форматов описания системы координат, с которыми вы должны быть «на ты» по окончании курса геоинформатики. Другой формат — коды EPSG (удобный ресурс для поиска — epsg.io). Эта международная база систем координат интегрирована почти во всё современное геоинформационное и окологеоинформационное ПО, включая QGIS. Третий вариант — описание систем координат в формате Well-Known Text (WKT), применяемое в ArcGIS и некотором другом ПО. Скопируйте строку PROJ в буфер обмена Также вставьте скопированную строку в отчётный документ В QGIS откройте меню Установки — Пользовательские проекции… Нажмите кнопку Добавить новую проекцию В полях для ввода ниже введите название проекции: Azimuthal Equidistant (Caucasus), в поле «Параметры» скопируйте строку PROJ. Нажмите ОК. Вы успешно добавили новую систему координат в пользовательский список. Теперь нужно применить её к проекту. Откройте интерфейс выбора системы координат. Это можно сделать не только нажатием на элемент в правом нижнем углу, но и через меню Проекты — Свойства… (вкладка Система координат). В открывшемся меню найдите в списке свою проекцию, выберите её и нажмите ОК. Скриншот 2: Окно QGIS после изменения проекции Закройте интерфейс выбора системы координат и нажмите правой кнопкой на слой 30n030e_20101117_gmted_mea075 в таблице слоёв. В контекстном меню выберите Свойства… и в открывшемся окне перейдите на вкладку Информация. Вы видите, что проекция набора данных не изменилась. Просто QGIS умеет трансформировать наборы данных для отображения их в целевой проекции. Это называется «перепроецирование на лету́». 1.4 Навигация по карте В начало упражнения ⇡ После изменения проекции центр карты сместился таким образом, что загруженный растр перестанет помещаться во фрейм карты. Нам в любом случае необходимо увеличить масштаб и переместить изображение, чтобы иметь возможность рассмотреть территорию картографирования более детально. Воспользуемся этим как поводом для освоения инструментов панели инструментов перемещения по карте: Изучите функционал инструментов перемещения по карте. Некоторые из них могут быть задействованы независимо. Например, масштабирование выполняется прокруткой колеса мыши, а перемещение по карте — движением мыши с зажатой средней кнопкой. Когда освоитесь с функциями перемещения по карте, установите масштаб карты равным 1:5 000 000. Это можно сделать в элементе «Масштаб» в нижней панели QGIS. После этого переместите изображение таким образом, чтобы Кавказские горы простирались из северо-западного угла к юго-восточному. 1.5 Оформление рельефа В начало упражнения ⇡ Изображение рельефа, которые вы видите, представляет собой так называемую аналитическую отмывку по высоте. Для аналитической отмывки используется шкала оттенков серого, применяемая по умолчанию. Мы будем использовать аналитическую отмывку по высоте вместе со светотеневой отмывкой. Откройте свойства слоя 30n030e_20101117_gmted_mea075 и перейдите на вкладку Стиль. Измените тип представления с Одноканальное серое на Одноканальное псевдоцветное. Установите минимальное значение равным 0, а максимальное значение — 4000. В строке выбора градиента нажмите правой кнопкой на шкалу и в открывшемся контекстном меню выберите опцию Создать новый градиент В появившемся всплывающем окне в ниспадающем списке выберите тип градиента Catalog: cpt-city (подробнее о cpt-city) В открывшемся каталоге в разделе Topography выберите градиент c3t3 и нажмите OK После нажатия OK были закрыты все окна, кроме окна свойств слоя 30n030e_20101117_gmted_mea075. Нажмите OK, чтобы применить изменения символики и закрыть окно. Вы успешно применили аналитическую отмывку по высоте к цифровой модели рельефа. Но для красочного, визуально привлекательного изображения этого недостаточно. Помимо аналитической отмывки по высоте, мы создадим светотеневую отмывку. Щёлкните правой кнопкой мыши по слою 30n030e_20101117_gmted_mea075 в таблице слоёв и в контекстном меню нажмите Дублировать слой. Дубликат слоя будет помещён в таблице слоёв ниже исходного слоя, выключен, а к его имени будет приписано “копия”. Обратите внимание, что оба слоя используют один и тот же источник данных. Вы можете сделать сколько угодно слоёв с разными настройками визуализации на базе одного и того же набора пространственных данных. Но если вы измените используемый набор пространственных данных, это повлечёт за собой автоматическое изменение вида слоёв (но не настроек их визуализации). Используя контекстное меню или окно свойств слоя, переименуйте оба слоя. Нижний слой назовите Аналитическая отмывка по высоте, верхний — Светотеневая отмывка. Названия слоёв никак не затрагивают источник пространственных данных. До тех пор, пока вам не приходится работать со слоями с помощью скриптов на языке Python, вы можете никак не ограничивать себя в названиях. Включите отображение нижнего слоя. Откройте свойства слоя «Светотеневая отмывка», перейдите на вкладку «Стиль». Измените способ визуализации на Теневой рельеф и нажмите Применить. При этом изменения будут применены, но окно свойств не закроется. На заднем плане вы видите изменения, произошедшие с вашим слоем. Во-первых, изображение светотеневой отмывки полностью закрыло изображение аналитической отмывки по высоте. Эту проблему можно решить, включив настройки прозрачности для слоя. Во-вторых, сама светотеневая отмывка выглядит очень тёмной. Это связано с несовпадением единиц измерения «по горизонтали» и «по вертикали» в исходном наборе данных. В нашем случае эту проблему можно решить двумя путями: трансформировать слой в проецированную систему координат или применить коэффициент масштабирования по вертикали (Z-factor). Мы пойдём вторым путём и будем изменять значение коэффициента масштабирования. Коэффициент масштабирования представляет собой переводной коэффициент из «вертикальных» единиц измерения в «горизонтальные». Поскольку «горизонтальные» единицы в нашем случае — градусы, и поскольку протяжённость одного градуса по долготе и по широте не совпадает, с его вычислением могут возникнуть сложности. Вопрос*: Рассчитайте коэффициент масштабирования по отношению к 1° долготы и 1° широты (на широте параллели касания проекции), ответ запишите в виде обыкновенной дроби. Чтобы не тратить время на точные расчёты, мы воспользуемся значением 0,000012 Помимо переводного коэффициента между единицами измерения, нам нужно дополнительно масштабировать высоты по вертикали, чтобы отмывка выглядела более «рельефно». В разных случаях применяется дополнительный множитель в диапазоне от 1,5 до 10, мы воспользуемся коэффициентом 5. Перемножьте оба коэффициента и введите полученное значение в качестве Z-фактора слоя. Перейдите на вкладку Прозрачность и установите коэффициент непрозрачности для слоя равным 50 %. Примените изменения, закройте окно свойств слоя и сохраните проект. Скриншот 3: полученное изображение рельефа Примечание для картографов: настройки визуализации рельефа, которые вы применили в этом упражнении, подобраны «на скорую руку», без предварительного анализа распределения высот картографируемой территории и выбора оптимальной шкалы. Эти вопросы подробно освещаются в курсах «Оформление карт» и «Общегеографическое картографирование». 1.6 Добавление векторных наборов данных В начало упражнения ⇡ Вновь откройте менеджер источников данных в виде браузера и перейдите в директорию «Размещение по умолчанию для проекта». Раскройте папку vector_data. Размещение по умолчанию для проекта — это директория, в которую был сохранён проект QGIS (*.qgz). Default location Вы видите несколько источников данных, обозначенных символом . Это векторные наборы данных, представленные в формате шейп-файлов. Теперь откройте эту же директорию через Проводник Windows (или любой другой файловый менеджер). Сравните количество файлов в Проводнике с количеством доступных источников данных в браузере QGIS Шейп-файлы были базовым форматом ГИС-пакета ArcView и за счёт этого получили очень широкое распространение. Шейп-файлы не такие функциональные, как базы геоданных ESRI (современный базовый формат для продуктов линейки ArcGIS) или GeoPackage, но тем не менее их продолжают активно использовать. Многие особенности шейп-файлов обусловлены спецификой и возможностями компьютеров начала 90-х гг. В частности, геометрия набора данных хранится отдельно (в файле .shp), семантика — отдельно (в формате dBASE, .dbf), а для связи между ними используется индекс-файл (.shx). Эти три файла — обязательные компоненты шейп-файла. Помимо них, отдельно могут быть записаны сведения о проекции (.prj), кодировке (.cpg) и многое другое. При копировании шейп-файла через Проводник необходимо копировать все файлы с одинаковым именем целиком. Добавьте на карту наборы данных об объектах гидрографии (hydrography-polyline.shp, hydrography-polygon.shp). В таблице слоёв разместите линии над полигонами. Переименуйте слои в «Водотоки» и «Водоёмы» соответственно. Все векторные наборы данных для этого упражнения созданы на основе цифровых географических основ ВСЕГЕИ. Это один из немногих общедоступных источников пространственных данных общегеографического содержания на территорию нашей страны и ближнего зарубежья. Настройте символику для добавленных векторных наборов данных. Также, как и для растров, настройки символики векторных данных помещаются в свойствах слоя, на вкладке «Стиль». Для полигонов гидрографии установите стандартный стиль topo water из библиотеки QGIS. Для линейных объектов используйте стандартный стиль simple blue line, но уменьшите толщину линии до 0,26 мм Если приглядеться, то можно увидеть, что знак контура береговой линии и знаки линейных объектов гидрографии на суше не совпадают. Можно изменить цвет и толщину обводки для полигонов объектов гидрографии, сделав их такими же, как у рек и каналов. Добавьте к карте железные дороги и автодороги. Переименуйте слои и изобразите их линиями толщиной 0,26 мм. Для автодорог используйте красный цвет, для железных дорог — тёмно-серый (20 % светлоты). 1.7 Использование атрибутов объектов при визуализации В начало упражнения ⇡ До этого момента мы работали только визуальным представлением слоя и никак не касались семантической составляющей. На следующем шаге вы будете использовать разные значки для различных типов объектов в одном слое. Добавьте к карте набор данных adm_line, переместите добавленный слой ниже всех линейных объектов и переименуйте его в «Границы». Вызовите контекстное меню слоя «Границы» и выберите опцию «Открыть таблицу атрибутов». Откроется таблица атрибутов источника данных. Attribute Table Таблица атрибутов — это представление базы данных, связанной с набором пространственных объектов. База функционирует по общим правилам реляционной базы данных: каждый объект представляется одной «строкой», в каждом столбце (поле) одному объекту соответствует одно значение. Атрибуты играют важную роль в геоинформационных системах. На их основе происходит визуализация данных, также они участвуют в большинстве операций пространственного анализа. В этом упражнении вы используете атрибуты, чтобы присвоить различные стили объектам в одном слое. Закройте таблицу атрибутов, откройте свойства слоя на вкладке «Стиль» Измените тип визуализации с Обычный знак на Уникальные значения. Эта настройка позволяет присваивать объектам различные стили в соответствии со значениями определённого атрибута. В выпадающем списке Поле выберите столбец, по которому будет происходить классификация, и нажмите кнопку Классифицировать внизу формы. В форму добавились три записи. Две из них представляют фактически имеющиеся значения атрибутов, третья — «пустая» — предназначена для визуализации всех остальных значений (которых фактически нет в таблице на настоящий момент, но которые могут появиться позже в результате редактирования) Classes Возможности автоматической настройки визуализации у QGIS пока невелики по сравнению с ArcGIS или MapInfo. Например, сейчас нашим классам присвоены стили в виде линий, у которых совпадают все параметры, кроме цвета. По-другому QGIS (пока) не умеет . Наша задача — создать разные условные знаки для разных типов границ Дважды щёлкните на значке, соответствующем классу Границы государственные. Откроется уже знакомый вам интерфейс настройки условных знаков. Обратите внимание на форму в левом верхнем углу: вы можете задать несколько слоёв для одного условного знака. Разумеется, слои в таблице слоёв и слои условного знака — это две не связанные между собой сущности Создайте для государственных границ двухслойный знак. Нижний слой: линия серого цвета (75 % светлоты) шириной 1 мм, с плоскими концами (чтобы концы линии не «свешивались» в воду). Верхний слой: линия тёмно-серого цвета (светлота 20 %) толщиной 0,26 мм, штрихпунктирная, с плоскими концами. Создайте аналогичный знак для границ субъектов РФ. Нижний слой: линия серого цвета (75 % светлоты) шириной 0,8 мм, с плоскими концами. Верхний слой: линия тёмно-серого цвета (светлота 20 %) толщиной 0,26 мм, штриховая, с плоскими концами. Для прочих границ используйте однослойный условный знак: пунктирная линия тёмно-серого цвета Вы успешно настроили разные условные знаки для различных типов объектов в слое. Сохраните проект. Далее мы не будем напоминать вам о необходимости сохранять проект карты. Делайте это самостоятельно. 1.8 Подписи В начало упражнения ⇡ Добавьте на карту набор данных elevation_points.shp, расположите слой на самом верху списка и переименуйте его в «Вершины». Настройте отображение единым знаком в виде чёрного треугольника, аналогично тому, как высочайшие отметки показываются в школьных атласах. Откройте таблицу атрибутов слоя. Какие поля можно использовать для подписей? На общегеографических картах обычно приводятся высоты и названия горных вершин. В этом упражнении мы ограничимся названиями. Закройте таблицу атрибутов и откройте свойства слоя. Перейдите на вкладку «Подписи». Переключите режим подписей на Single labels («Подписывать объекты значением атрибута»). В открывшемся меню в выпадающем списке «Подписывать значениями» выберите поле Name — тексты подписей будут «считываться» из него. В поле Text sample отображается пример подписи с теми настройками, которые заданы по умолчанию. Если вы будете менять настройки подписей (шрифт, форматирование, «гало» и др.), этот приме будет меняться. Сейчас мы последовательно пройдём по вкладкам настройки подписей, исправив необходимые параметры. На вкладке Текст установите гарнитуру («шрифт») Times New Roman, начертание («стиль») полужирный курсив, кегль («размер») 8. На вкладке Тень включите опцию «Рисовать падающую тень». Это повысит читаемость подписей на карте. Также с целью повышения читаемости подписей можно использовать обводку («Буфер») и фон (англ. Background, неправильно переведён как «История»). На вкладке Размещение выберите опцию «Картографическое», расстояние 0,1 мм от границ символа (from symbol bounds) Примените настройки подписей и закройте свойства слоя В каталоге vector_data остался незадействованный слой — population_points. Добавьте его в проект? переименуйте и самостоятельно настройте условные знаки и подписи. Используйте параметр уникальные значения для того, чтобы отобразить города с разной численностью населения разными условными знаками. Скриншот 4: окно QGIS после завершения настройки символов 1.9 Настройка компоновки карты В начало упражнения ⇡ Изображение, которое вы видите во фрейме данных, можно экспортировать «как есть» (с помощью опции «Проекты» — «Импорт/экспорт» — «Экспортировать карту как изображение…»). Однако для картографических целей мы, как правило, формируем компоновку карты — размещаем картографическое изображение на листе, добавляем название, легенду, масштабную линейку и элементы зарамочного оформления. Сейчас мы создадим макет компоновки с расчётом на то, что итоговая карта будет вставлена в отчёт. Создайте новый макет компоновки («Проект» — «Создать Макет…») или Ctrl+P. Введите название макета на своё усмотрение. После ввода названия откроется окно компоновки (Layout) Добавьте на лист картографическое изображение. Для этого используется инструмен «Добавить карту» из панели инструментов. Выберите инструмент и «растяните» прямоугольник карты на листе. После добавления элемента откроется панель его свойств. Изучите настройки, доступные в этой панели, а затем установите для карты знаменатель масштаба 4 000 000 и размеры 237 × 130 мм. В том же разделе, где устанавливаются размеры элемента, задайте для элемента карты положение по X = 30 мм и положение по Y = 30 мм. Положение элемента на листе отсчитывается от верхнего левого угла листа до точки привязки элемента. Добавьте к карте градусную сетку. Для этого в свойствах элемента найдите раздел «Сетки», нажмите на кнопку Добавить новую сетку, а затем Modify Grid. Откроется меню настройки сетки. Задайте для сетки проекцию WGS84, интервал по долготе — 4°, интервал по широте — 2°. Также уменьшите толщину линий сетки до 0,1 мм. Для этого щёлкните левой кнокой мыши по элементу Стиль линии, откроется уже привычный вам интерфейс настройки условного знака. Вернуться обратно к настройкам сетки можно, нажав на кнопку «Назад» в левом верхнем углу интерфейса. Добавьте рамку сетки в виде простой линии и включите отображение подписей координатной сетки. Настройте отображение подписей так, чтобы широта подписывалась только вдоль западной и восточной рамки, а долгота — только вдоль северной и южной. Используйте формат координат Десятичные с окончанием и нулевое число знаков после запятой (этот параметр в QGIS называется «Точность координат») Вернитесь к макету и передвиньте картографическое изображение внутри элемента таким образом, чтобы вместилась вся основная часть Главного Кавказского хребта. Можно ориентироваться на города: в северо-западном углу карты должен отображаться Краснодар, в юго-восточном — Баку. Для перемещения карты внутри фрейма используется инструмент «Перемещение содержимого элемента» Добавьте на лист название карты. Для этого вставьте новую надпись и разместите её над элементом карты. Введите название карты «Кавказские горы», используйте выключку по середине, настройте параметры шрифта на своё усмотрение. Добавьте на лист масштабную линейку. Переместите линейку в юго-западный угол карты, установите для неё отображение фона и границы, исправьте обозначение единиц измерения. Уменьшите высоту линейки, кегль шрифта и отступы подписей, чтобы линейка смотрелась более компактно. Добавьте на лист легенду. Легенда будет собрана автоматически на основе тех настроек визуализации, которые применены для слоёв карты. Отредактируйте легенду. Для этого сначала выключите автообновление (Auto update) элементов легенды, чтобы сделать список элементов доступным для редактирования. Удалите из легенды те условные знаки, которые не встречаются на карте, и переименуйте неинформативные или пустые подписи. Добавьте обводку для элемента легенды и разместите элемент в северо-восточном углу карты. Добавьте ещё один текстовый элемент и впишите в него сведения об авторстве. Экспортируйте получившуюся карту в изображение формата PNG («Макет» — «Экспорт в изображение…» или специальная кнопка на главной панели инструментов макета). "],
["map-design-quaternary.html", "Упражнение 2 Создание карты четвертичных отложений 2.1 Введение 2.2 Начало работы 2.3 Добавление данных в проект 2.4 Применение готового стиля к слою 2.5 Создание набора пространственных данных из таблицы с координатами 2.6 Оформление карты", " Упражнение 2 Создание карты четвертичных отложений Архив с данными и файлом отчёта 2.1 Введение Цель задания — закрепление навыков загрузки и визуализации данных в QGIS. Необходимая теоретическая подготовка: модели пространственных данных, модели пространственных объектов, базы пространственных объектов, картографические проекции. Необходимая практическая подготовка: в объёме упражнения 1. Исходные данные: база геоданных ESRI на территорию Сатинского учебного полигона, Калужская область. Ожидаемый результат: карта четвертичных отложений Сатинского полигона М 1:30 000 2.1.1 Контольный лист Добавить на карту источники пространственных данных Импортировать символику Настроить подписи объектов Создать набор пространственных данных из текстового файла Создать компоновку карты и легенду Экспортировать результат в графический файл 2.2 Начало работы В начало упражнения ⇡ Скачайте архив с исходными данными для упражнения и распакуйте его в свою рабочую директорию. В вашей рабочей директории появилась «папка» Satino.gdb. Зайдя в неё с помощью проводника или Finder’a, вы увидите множество файлов с различными расширениями (.spx, .gdbtable, *.gdbtablx и др.). Ничего не редактируйте в этой «папке». Запустите QGIS и сразу сохраните проект в своей рабочей директории, на одном иерархическом уровне с Satino.gdb. Назовите его по шаблону Ex02_%Фамилия.qgz%. Примечание: не забывайте периодически сохранять проект QGIS! Откройте Менеджер источников данных и разверните содержимое базы Satino.gdb Вы видите список наборов пространственных данных, хранящихся в базе Satino.gdb. Это векторные наборы различной геометрии (точечной, линейной и полигональной). База геоданных ESRI (*.gdb) — основной формат, используемый линейкой программных продуктов ArcGIS. В базах геоданных могут храниться как векторные, так и растровые данные. Кроме того, базы геоданных поддерживают специальные возможности (подтипы, доменты) и структуры данных (топологические и сетевые наборы). QGIS способен получать доступ к базам геоданных ESRI в режиме чтения, но не в режиме редактирования. И даже эти возможности ограничены: QGIS «видит» векторные наборы пространственных данных, но «не считывает» структуру базы (классы и наборы пространственных объектов), растровые наборы, топологию и другие элементы, специфические для ArcGIS. В частности, набор DEM, который отображается в браузере как векторный полигональный набор данных, на самом деле является растровым набором. 2.3 Добавление данных в проект В начало упражнения ⇡ Добавьте на карту наборы WaterLine, WaterPolygon и QDeposit. Вопрос 1: какая система координат присвоена для каждого набора данных? Какая проекция используется для этой системы координат? К какому виду относится эта проекция по характеру искажений? Для чего она применяется? Вопрос 2: какая система координат присвоена проекту QGIS после добавления набора данных? Настройте визуализацию слоёв WaterLine и WaterPolygon, используя условные знаки из библиотеки QGIS. Окно QGIS должно принять вид, аналогичный рисунку ниже: Откройте таблицу атрибутов слоя QDeposit и изучите её. Вы видите индексы и текстовые описания четвертичных отложений. Далее вы визуализируете слой QDeposit таким образом, что каждому типу отложений (Deposit) будет сопоставлен уникальный условный знак. 2.4 Применение готового стиля к слою В начало упражнения ⇡ Откройте свойства слоя QDeposit. На вкладке «Стиль» измените тип отображения на Уникальные значения и настройте классификацию по полю Index c использованием случайных цветов (Random colors). Закройте свойства слоя и оцените результат. Скриншот 1: результат классификации — отображение каждого типа отложений уникальным цветом. Изображение стало более «пёстрым», но не стало более читаемым. Человеческому глазу трудно распознать два десятка уникальных оттенков цвета. Кроме того, исходя из географической логики, родственным категориям должны быть присвоены схожие цвета. Разработка цветовых решений для сложных, комплексных карт является отдельной научной задачей. В этом упражнении вы будете использовать готовые наборы стилей. В левом нижнем углу вкладки «Стиль» найдите кнопку «Стиль». Нажмите на неё и выберите опцию «Загрузить стиль». В открывшемся окне в строчке «Файл» найдите стилевой файл QDeposit.qml. Загрузите из этого файла всю доступную символику. QGIS, как и другое геоинформационное ПО, позволяет сохранять настройки отображения слоя в отдельный стилевой файл. Поддерживаются два формата: QGIS Layer Style File (.qml) и Styled Layer Descriptor (.sld). В проприетарном ПО (ArcGIS, MapInfo) используются другие форматы описания стилей. Как правило, они несовместимы друг с другом. Скриншот 2: изображение готового слоя после импорта символики Изучите условные знаки, применённые для слоя, и ответьте на вопросы: Вопрос 3: чем отличается условный знак, применённый для биогенных отложений, от всех прочих условных знаков? Каким образом это осуществлено? Вопрос 4: как соотносятся записи в таблице атрибутов (поле Deposit) и записи в поле «Легенда» в настройках стиля условных знаков? Настройте подписи для слоя. Для подписывания используйте поле Index. Настройки подписей определите самостоятельно. 2.5 Создание набора пространственных данных из таблицы с координатами В начало упражнения ⇡ Найдите в проводнике файл geol_points.csv и откройте его с помощью простого текстового редактора (Блокнот или аналогичный). Изучите содержимое файла. Comma-Separated Values (CSV) — простой текстовый формат, предназначенный для хранения табличных данных. Каждая строка представляет строку таблицы, а ячейки, соответствующие столбцам, разделяются специальными символами. В качестве такого символа может быть использована запятая, точка с запятой, знак табуляции или сочетание из нескольких символов. В представленном файле вы видите два столбца — X и Y. Это представление координат точек. Система координат, которая использовалась при создании файла, совпадает с системой координат вашего проекта. На следующих шагах вы загрузите эту таблицу в QGIS как набор пространственных данных. Откройте панель менеджера источников данных и перейдите на вкладку Delimited Text. Поскольку текстовый файл не содержит сведений, необходимых для корректного импорта и визуализации, мы будем настраивать параметры импорта вручную. Нажмите значок с символом ... справа от первого поля и в окне Проводника откройте файл geol_points.csv. Не меняйте имя слоя и кодировку. Примечание: в дальнейшем в вашей практике будут встречаться CSV-файлы, созданные в различных кодировках. В таких случаях нужно будет выбрать (или подобрать) правильную кодировку. Проверить себя можно по образцу загружаемой таблицы, который отображается в нижней части интерфейса загрузчика. В первом блоке настроек («Формат файла») установите корректный разделитель столбцов. Во втором блоке настроек («Настройки полей и записей») установите нужные параметры самостоятельно. В третьем блоке настроек («Геометрия») определите, какие поля содержат координаты точек, и установите целевую систему координат — такую же, как система координат проекта. В блоке «Настройки слоя» не меняйте значения, определённые по умолчанию. Проверьте себя, посмотрев блок «Примеры данных». Если настройки заданы правильно, в этом блоке будут корректно отображены первые 20 строк таблицы (не считая заголовков). Скриншот 3: Окно настроек импорта CSV-файла Нажмите кнопку «Добавить», чтобы добавить слой на карту. Настройте условные знаки для добавленного слоя. Отобразите все разрезы чёрными кругами диаметром 1,4 мм без обводки. 2.6 Оформление карты В начало упражнения ⇡ Создайте макет карты в портретной ориентировке и добавьте на него картографическое изображение. Установите следующие параметры элемента карты: ширина 170 мм, высота 140 мм, масштаб картографического изображения 1:30 000. Разместите элемент карты в верхней половине листа Настройте сетку прямоугольных координат для карты в виде перекрестий. Подсказка: используйте для сетки ту же систему координат, которая применена для проекта QGIS в целом Добавьте зарамочное оформление: название карты, легенду, масштабную линейку. Экспортируйте карту в формат PNG и вставьте её в отчётный документ. Подсказка: используйте опцию «Обрезать по содержимому», чтобы сохранить размеры изображения в отчётном документе "],
["map-ref-districts.html", "Упражнение 3 Привязка и цифрование административной карты 3.1 Введение 3.2 Добавление базовых данных 3.3 Привязка карты 3.4 Создание слоя избирательных округов 3.5 Расчет статистики по округам 3.6 Построение картодиаграмм 3.7 Использование базовых слоёв из сети Интернет 3.8 Оформление итоговой схемы", " Упражнение 3 Привязка и цифрование административной карты Архив с данными и файлом отчёта 3.1 Введение Цель задания — знакомство с привязкой, трансформированием и цифрованием геоизображений, элементами базовых технологий ГИС (оверлей, пространственные запросы). Необходимая теоретическая подготовка: Системы координат и проекции карт, привязка геоизображений, трансформирование геоизображений, цифрование геоизображений. Методы трансформации: аффинное, проективное, полиномиальное, метод резинового листа (сплайны). Пространственные запросы, атрибутивные запросы, оверлей. Необходимая практическая подготовка: Знание основных компонент интерфейса QGIS (менеджер источников данных, панель слоёв, фрейм карты, окно настройки компоновки). Добавление источников пространственных данных в проект. Настройка символики и подписей объектов. Создание макета, добавление карты и зарамочного оформления, экспорт макета. Исходные данные: Cлои картографической основы OpenStreetMap, растровая карта избирательных округов г. Белгорода. Результат: Набор пространственных данных с избирательными округами г. Белгорода и статистикой по застройке в пределах округов. Картодиаграммы по количеству домов и степени застроенности. Картографическое изображение. 3.1.1 Контрольный лист Привязать растровую карту к опорным данным Создать класс избирательных округов путем цифрования растровой карты Добавить номера районов в таблицу атрибутов Определить (путем применения серии пространственных запросов) структуру застройки в каждом округе Построить картодиаграммы по полученным значениям Подготовить проект карты с компоновкой 3.2 Добавление базовых данных В начало упражнения ⇡ Скачайте архив и распакуйте его в свою рабочую директорию. Создайте проект QGIS и сохраните его в распакованную папку (Ex05_RefAdm) в своей рабочей директории. В менеджере источников данных найдите расположение проекта и разверните содержимое базы belgorod.gpkg. Формат GeoPackage был предложен в середине 2010-х как открытая альтернатива существующим форматам хранения пространственных данных: шейп-файлу и базам геоданных ESRI. GeoPackage представляет собой базу данных SQLite, внутри которой содержатся таблицы с данными и таблицы с метаданными. Такой подход аналогичен базе геоданных ESRI. Однако, в отличие от базы геоданных и от шейп-файлов, GeoPackage хранит всю необходимую информацию в одном файле (*.gpkg). Это позиционируется как одно из главных преимуществ формата. Добавьте все наборы из базы belgorod.gpkg на карту. Примечание: проще всего сделать это через менеджер источников данных. Другой вариант — перетащить файл из окна системного файлового менеджера. Разместите слои в следующем порядке и настройте их символику: железные дороги: тёмно-серые линии толщиной 0,4 мм; автодороги: светло-оранжевые линии толщиной 0,26 мм; здания и сооружения: заливка светло-серого цвета без обводки; водоёмы: используйте стиль topo water; водотоки: синие линии толщиной 0,26 мм; административные границы: иcпользуйте стиль outline red. Задайте слоям русскоязычные названия Отобразите карту в охвате слоя границ. Скриншот 1: окно QGIS после завершения настройки символики Вопрос 1: какая система координат используется в проекте? Для чего обычно применяется эта система координат? 3.3 Привязка карты В начало упражнения ⇡ Для привязки растров в QGIS имеется модуль «Привязка растров (GDAL)». Чтобы запустить его, выберите «Растр» — «Привязка растров…». Откроется окно модуля привязки. Примечание: Если в меню «Растр» нет нужного пункта, следует зайти в меню «Модули» — «Управление модулями…» и в разделе «Установленные» включить модуль «Привязка растров (GDAL)». «Привязка растров» — модуль, который входит в ядро QGIS, он обязательно устанавливается вместе с основной программой. В окне привязки нажмите кнопку «Открыть растр» и откройте файл ElectionMap.jpg, который находится в вашей рабочей директории. При загрузке QGIS попросит вас указать систему координат для добавляемого растра. Выбирайте ту же систему координат, которая используется в проекте. Расположите окно модуля привязки таким образом, чтобы оно не закрывало основной фрейм карты. Выключите панели инструментов QGIS, если они вам мешают. Обратите внимание, что растровое изображение выглядит искажённым («сплюснутым») по сравнению с изображением в основном окне QGIS. Если вы откроете растр в какой-либо программе просмотра изображений, вы убедитесь, что растр действительно будто бы «сжат» по вертикали. Перемещаясь по карте, найдите соответствующие точки на изображении и в основном окне QGIS Используя инструмент «Добавить точку» в окне модуля привязки, установите первую точку на растровом изображении (щелчком левой кнопки мыши). QGIS выдаст запрос на ввод координат: В некоторых случаях можно ввести координаты вручную, но нам будет проще «снять их с карты», то есть указать соответственную точку в основном окне QGIS. Нажмите кнопку «С карты». Окна модуля привязки при этом свернутся. Щёлкните левой кнопкой мыше в соответствующей точке основного окна QGIS. Программа автоматически считает координаты точки и подставит их в форму: Нажмите OK, чтобы добавить первую опорную точку. Примечание: счёт опорных точек в QGIS начинается с нуля, поэтому первая точка получит индекс «0», вторая — «1» и так далее. Найдите и расставьте ещё 7-8 опорных точек.. Точки должны быть равномерно распределены по полю карты и не находиться на одной линии. В качестве опорных точек лучше всего использовать пересечения автодорог и/или железных дорог. Кроме того, не следует использовать контура границ для расстановки опорных точек — в представленных материалах они не совпадают! Откройте окно параметров трансформации и ознакомьтесь с доступными параметрами трансформации. Вопрос 2: какие типы трансформации растра доступны в QGIS? В каких случаях они применяются? Сколько точек необходимо для осуществления каждого типа трансформации? Настройте параметры трансформации следующим образом: Тип трансформации: Проективная; Метод интерполяции: Ближайший сосед; Целевая система координат: такая же, как СК проекта; Остальные параметры оставьте по умолчанию Обязательно включите опцию «Открыть результат в QGIS» Нажмите ОК, чтобы закрыть окно параметров трансформации и сохранить изменения настроек. Изучите таблицу опорных точек, которая отображается внизу окна модуля привязки. Если суммарная невязка для какой-либо точки превышает 0,5 пикселя, отключите её и добавьте новую точку. Не удаляйте отключённые точки! Подсказка: чтобы легче было ориентироваться в опорных точках, можно включить отображение идентификаторов точек в настройках модуля привязки. Вопрос 3: Можно ли загружать и сохранять опорные точки привязки в QGIS? Если да, как это сделать? Когда точность всех активных опорных точек составит меньше 1 пикселя, нажмите кнопку , чтобы запустить процесс привязки. В результате будет создан новый файл, который автоматически добавится в основное окно QGIS. Изучите результат привязки. Если он устраивает вас, окно привязки можно закрывать. Если нет, удалите добавленный слой, вернитесь в окно привязки, внесите необходимые изменения и запустите привязку ещё раз. Скриншот 2: окно QGIS после завершения привязки. 3.4 Создание слоя избирательных округов В начало упражнения ⇡ Отключите все слои, кроме административных границ. Измените стиль слоя границ на outline black. Разместите привязанный растр в таблице слоёв под слоем административных границ. Мы готовы к тому, чтобы начать векторизовать («цифровать») контура избирательных округов. Но для этого нам нужен набор данных, в который мы будем сохранять создаваемые объекты. На следующем шаге мы создадим такой набор данных. Создайте новый набор данных GeoPackage. Это можно сделать из панели источников данных, из меню «слой» или нажав комбинацию клавиш Ctrl+Shift+N. Откроется окно настройки нового слоя. Заполните поля в открывшемся окне следующим образом: База данных: сохраните файл *.gpkg в папку Ex05_RefAdm. Назовите его по шаблону Belgorod_%фамилия%.gpkg; Имя таблицы: примите значение, предлагаемое по умолчанию после указания пути к базе; Тип геометрии: (определите самостоятельно) Чекбоксы «Include Z dimension» и «Include M values» оставьте выключенными; Система координат: такая же, как система координат проекта. Блоки New Field и Fields List предназначены для настройки таблицы атрибутов создаваемого набора данных. В блоке New Field вводится имя, тип и длина поля, по нажатию кнопки Add to Fields list создаваемое поле добавляется в список. Добавьте поле district_id целочисленного типа в список полей. не раскрывайте блок Advanced Options, они не интересуют нас в рамках этого упражнения. После применения всех настроек окно создания нового набора будет выглядеть аналогично представленному на экране: Нажмите ОК, чтобы создать источник данных. Новый слой автоматически добавится в проект. На следующих шагах вы будете создавать новые пространственные объекты в этом слое. Измените стиль слоя на pattern dot red. Такая символика удобна для цифрования, поскольку позволит не «скрывать» растровый слой под созданными объектами. Редактирование данных в ГИС по умолчанию «выключено». Чтобы получить возможность редактировать наборы данных, нужно включать специальный режим редактирования. В QGIS этот режим включается отдельно для каждого слоя. Чтобы включить режим редактирования, выберите слой, который вы собираетесь редактировать, в таблице слоёв и нажмите кнопку на панели инструментов оцифровки. Включив режим редактирования, нажмите кнопку «Добавить объект» в панели инструментов оцифровки, чтобы добавить новый объект. Внешний вид и название этой кнопки будут отличаться в зависимости от типа геометрии слоя. Включите панель инструментов прилипания, если она ещё не включена. Примечание: прилипание (snapping, снеппинг) и его частный случай — трассировка (tracing) — исключительно важные функции программных средств ГИС. Они позволяют повторять контура уже существующих объектов при редактировании. Это не только ускоряет процесс, но и позволяет соблюдать специфические геоинформационные требования к топологии пространственных данных. В панели инструментов прилипания: Включите прилипание; Установите режим прилипания «к вершинам и сегментам» Порог прилипания — не меньше 10 пикселей Включите трассировку (Tracing) Эти настройки нужны, чтобы контура создаваемых вами объектов повторяли контура слоя административных границ, где это необходимо. Теперь вы готовы к тому, чтобы оцифровать свой первый контур. Ваша задача будет состоять в том, чтобы оцифровать границы избирательных округов в пределах одного из административных округов Белгорода (Западного или Восточного). Увеличьте изображение таким образом, чтобы видеть избирательные округа возле южного сегмента границы двух административных округов. Нажмите левой кнопкой мыши на карте в месте, где проходит граница избирательного округа и не проходит граница административного округа. По нажатию левой кнопки мыши устанавливается положение первого узла создаваемого контура. «Обходите» контур по часовой стрелке или против часовой стрелки, устанавливая новые узлы. Не пугайтесь, если QGIS отобразит зелёный крестик поверх вашего контура — таким образом маркируются самопересечения. Чтобы удалить последний введённый узел, нажмите Backspace. Чтобы сбросить контур целиком, нажмите Esc. Дойдя до границы административных округов, установите новый узел на ней. Место установки узла автоматически притянется к границе. Теперь переместите курсор вдоль границы. Наблюдайте за тем, как ориентируется контур создаваемого объекта. Установите следующий узел на границе подальше от точки касания. Когда границы округов «разойдутся», снова нажимайте левую кнопку мыши, чтобы установить новый узел в желаемой точке. Чтобы завершить редактирование, нажмите правую кнопку мыши. Откроется окно ввода атрибутов. Введите номер избирательного округа и нажмите ОК или Enter, чтобы применить изменения и закрыть окно ввода атрибутов. Новый объект добавлен в слой и отображается на карте. Примечание: неправильно введённый номер можно исправить в таблице атрибутов Векторизуйте остальные объекты в пределах выделенной вам половины г. Белгорода. Следуйте границам административных округов и ранее оцифрованных объектах. При незначительных различиях в границах цифруйте по границам административных округов, если расхождения большие — цифруйте по границам избирательных округов. Сохраните изменения в слое. Для этого нажмите кнопку «Сохранить правки» на панели инструментов оцифровки. Не выключайте режим редактирования. Примечание: сохранение правок в слое никак не сказывается на сохранении проекта и независимо от него. Вы можете сохранить проект, затем в другом проекте изменить один из наборов пространственных данных, затем вернуться в изначальный проект — и все изменения набора отобразятся в нём. На символику слоя это не повлияет. Отключите растровый слой. Включите для набора данных об избирательных округах подписи по полю district_id. Настройки подписей задайте самостоятельно. Скриншот 3: оцифрованные контура избирательных округов. 3.5 Расчет статистики по округам В начало упражнения ⇡ В данной части работы предлагается определить количество зданий разных типов (жилые многоэтажки и частная застройка), которые попадают в пределы каждого округа, затем построить картодиаграммы по полученным значениям. Для этого будет использован следующий алгоритм: Выбрать округ на карте Выбрать здания, попадающие в его пределы (пространственный запрос). Из полученной выборки оставить только здания, принадлежащие к определённому типу (атрибутивный запрос). Записать число отобранных зданий в соответствующий атрибут текущего района. Эти операции необходимо повторить для каждого округа. Не выключая режим редактирования, откройте таблицу атрибутов слоя. Нажмите кнопку «Добавить новое поле» или Ctrl+W на клавиатуре, чтобы добавить новый столбец в таблицу. Добавьте два целочисленных поля: count_apartments и count_house. Эти поля будут служить для подсчёта (count) многоквартирных жилых домов (apartments) и частной застройки (house) соответственно. Включите слой зданий. Выберите первый созданный вами контур округа: выделите строку в таблице атрибутов или воспользуйтесь инструментом выборки в окне карты . Выделенный объект будет подсвечен жёлтым цветом на карте и синим — в таблице атрибутов. Теперь выберите те объекты из слоя зданий, которые находятся внутри выбранного округа. Для этого запустите инструмент «Вектор» — «Выборка» — «Выделение по районам…». Используйте условие «находятся внутри» (are within). Нажмите «Выполнить», чтобы выбрать объекты в слое зданий. Имея выборку в слое зданий и не закрывая окно пространственного запроса («Выделение по районам…»), осуществите выборку по атрибутам. Для этого выберите в таблице слоёв слой зданий и нажмите кнопку «Выделить объекты, удовлетворяющие условию» . Откроется форма ввода атрибутивного запроса. Атрибутивные запросы в ГИС, как правило, создаются с использованием диалектов языка SQL. Само выражение представляет собой только условие (where clause) и часто использует значения атрибутов. Форма ввода атрибутивного запроса состоит из трёх частей. В левой части конструируется собственно запрос, средняя содержит список доступных переменных и функций, в правой отображается справочная и служебная информация. В структуре тегов OpenStreetMap многоэтажные жилые дома обозначаются тегом apartments. После конвертации данных OpenStreetMap в реляционную базу данных соответствующий тег содержится в поле buildings. Мы должны выбрать в слое зданий те объекты, значение атрибута buildings которых задано как apartments. Найдите в среднем поле группу «Поля и значения» и разверните её. Найдите поле «Building» и дважды щёлкните по нему левой кнопкой мыши. Поле будет добавлено в запрос, в нижней части окна появится пример результата запроса, а в правой части отобразится вспомогательная форма извлечения уникальных значений. Введите знак = в поле конструирования запроса. Нажмите кнопку All Unique, чтобы получить список уникальных значений, записанных в поле building. Дважды щёлкните по записи apartments в списке уникальных значений. Она будет добавлена в конструктор запроса. После применения всех действий окно конструктора запроса будет выглядеть, как на рисунке ниже: Вопрос 4: Почему в нижней части окна отображается запись «Предпросмотр: 0»? Мы сформулировали условие для выборки, однако нам нужно выбрать объекты не просто из слоя, а из уже существующей выборки. Для этого откройте выпадающий список кнопки «Выбрать объекты» и выберите функцию «Фильтровать текущее выделение»: После применения фильтра появится всплывающее сообщение с числом выбранных объектов. Эта информация будет продублирована внизу окна QGIS: Введите полученную цифру в таблицу атрибутов слоя избирательных округов. Повторите выборку поочерёдно для каждого округа. Вводите получаемые значения в таблицу атрибутов. Не забывайте периодически сохранять изменения! Теперь повторите выборку ещё раз, но уже не для многоквартирных домов, а для частных владений. Им соответствует запись house в поле building. Вопрос 5: вставьте в отчёт SQL-выражение для выбора частных владений. Вопрос 6: можно ли было делать выборку в другом порядке (т.е. сначала выборку по атрибутам, а затем — по пространственному положению)? Если да, то каковы были бы отличия процедуры? Скопируйте таблицу атрибутов в любой табличный процессор (Microsoft Excel, Google Sheets, LibreOffice Calc). Для этого при помощи сочетания клавиш Ctrl+A выделите все записи в таблице, скопируйте при помощи Ctrl+C и вставьте записи без форматирования в табличный процессор при помощи Ctrl+Shift+V. Удалите первый столбец (wkt_geometry). Скопируйте остальные столбцы и вставьте их в отчётный файл. 3.6 Построение картодиаграмм В начало упражнения ⇡ Диаграммы в QGIS создаются как настройка отображения слоя. Однако соответствующий блок располагается не на вкладке «Стиль», как «обычные» условные знаки, а на отдельной вкладке «Диаграммы». Инструменты создания диаграмм в QGIS пока ещё несовершенны и находятся в стадии активной разработки, поэтому, во-первых, некоторые настройки могут работать некорректно, во-вторых, в скором будущем возможно кардинальное изменение интерфейса настройки. Откройте свойства слоя избирательных округов и перейдите на вкладку «Диаграммы». В верхнем левом углу включите отображение круговых диаграмм. На вкладке «Атрибуты» добавьте атрибуты count_apartments и count_house в список включённых в диаграмму. Настройте мягкие, пастельные цвета для их отображения. Вкладку «Рендеринг» установите для диаграмм настройку прозрачности (70 %) На вкладке «Размер» измените способ задания размера с фиксированного на переменный («масштабируемый»). Изменение размера диаграмм в QGIS работает следующим образом. Пользователь задаёт максимальное значение показателя, который будет управлять размером диаграммы, и соответствующий ему максимальный диаметр диаграммы. Размер круга масштабируется пропорционально величине показателя. Из картографических соображений следует всегда выбирать масштабирование площади, а не линейного размера (диаметра). В качестве показателя можно использовать значение из какого-либо столбца таблицы атрибутов. Но можно и рассчитывать это значение непосредственно при визуализации. Мы воспользуемся вторым вариантом. Нажмите кнопку со значком в виде буквы ε справа от поля «Атрибут». Откроется уже знакомое вам окно конструирования выражений. Задайте выражение для суммирования значений полей count_apartments и count_house. Убедитесь, что расчёт выполняется кооректно (см. строку «Предпросмотр») и, если это так, нажмите OK. Вернувшись в окно настройки диаграмм, нажмите кнопку «Найти» в строке «Максимальное значение», чтобы автоматически рассчитать максимальный результат выражения. Округлите полученное значение в большую сторону до тысяч. Установите максимальный размер диаграмм равным 30 (мм). В QGIS есть ещё одна полезная опция — увеличение размера диаграмм. Она применяется, если при масштабировании некоторые диаграммы становятся слишком малы. В таком случае их размер увеличивается до минимального (задаваемого пользователем) порогового значения. После установки всех параметров окно должно принять следующий вид: Перейдите на вкладку «Легенда». Здесь вы настроите комбинацию условных знаков для отображения в легенде. Нажмите кнопку «Показать значки для размера диаграмм в легенде» (Show Legend Entries for Diagram Size). Настройте отображение значков следующим образом: «Коллапсируйте» значки легенды; В качестве символа используйте белый маркер круглой формы с тёмно-серой обводкой; Задайте заголовок («Число домов»); Задайте классы значков вручную: 100, 500, 1000, далее через 1000 до максимальной величины. Интерфейс настройки диаграммы должен принять приблизительно следующий вид: Важное замечание: конечно, такой набор значков не является картографически корректным для создания легенды к абсолютной непрерывной шкале значков. По состоянию на 2020-03-17 ни один широко используемый ГИС-пакет не может сделать легенду к размерам кругов картодиаграммы согласно принятым картографическим правилам. Легенды к таким картам следует составлять или исправлять вручную. 3.7 Использование базовых слоёв из сети Интернет В начало упражнения ⇡ Большинство современных программных средств ГИС даёт возможность использовать не только локальные данные, но и наборы, распространяемые через Интернет с использованием специальных протоколов (WMS, WFS, WCS и др.). В частности, таким способом можно добавлять в ваш проект базовые карты Google Maps, Яндекс.Карт и некоторых других сервисов. Разработан удобный плагин, позволяющий вам получить доступ к этим источникам «в один клик». Он называется QuickMapServices. Откройте меню управления подключаемыми модулями («Модули» — «Управление модулями…»), наберите в строке поиска QuickMapServices и установите найденный модуль. Установленный модуль будет доступен из выпадающего меню «Интернет»: Откройте настройки модуля QuickMapServices, перейдите на вкладку «Загрузить сервисы» и нажмите «Получить дополнительные источники данных». В список доступных сервисов добавится ряд дополнительных источников. Добавьте к проекту базовую карту OpenStreetMap Monochrome. Расположите слой с избирательными округами поверх базовой карты. Все остальные слои отключите. 3.8 Оформление итоговой схемы В начало упражнения ⇡ Создайте макет компоновки для оформления итоговой схемы. Добавьте карту к макету. Настройте оформление карты. Исходите из того, что ваша схема предназначена для вставки в отчёт: учтите ориентировку страницы, необходимость зарезервировать место под поля и др. В рамках этого упражнения не создавайте сетку координат, но добавьте рамку карты и отключите фон. Добавьте легенду и настройте её. Добавьте остальные необходимые элементы зарамочного оформления. Оцените получившееся изображение. При необходимости вернитесь в основное окно QGIS и измените настройки оформления слоёв. Экспортируйте схему с разрешением 96 точек на дюйм. Используйте опцию «Обрезать по содержимому». Примечание: разрешение 96 точек на дюйм считается довольно низким для картографических целей. Изображения с таким разрешением не годятся для печати, но иногда могут быть пригодны для размещения в Интернете. ВЫ снижаете разрешение для того, чтобы сохранить читаемость базовой карты. Вставьте итоговую схему в отчётный файл. "],
["manual-catalog.html", "A Форматы пространственных данных A.1 Шейп-файлы A.2 GeoPackage A.3 Базы геоданных ESRI", " A Форматы пространственных данных A.1 Шейп-файлы A.2 GeoPackage A.3 Базы геоданных ESRI "]
]
